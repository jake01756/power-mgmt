#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f main.sh -e 06/01/2022 -vSD -m This debug build has expired, please recompile to continue debugging. -o build/power-mgmt-debug 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[1]))
	"\157\032\006\253\142\311\311\134\051\134\331\355\052\241\216\336"
	"\120\245\237\317\136\214"
#define      pswd_z	256
#define      pswd	((&data[39]))
	"\070\176\160\265\324\207\040\026\065\045\362\020\305\313\354\352"
	"\061\301\203\347\365\253\134\061\257\154\235\362\010\243\155\217"
	"\241\024\255\334\213\075\201\232\165\270\075\267\142\202\013\377"
	"\104\216\347\071\072\104\152\351\260\010\334\271\254\112\111\115"
	"\136\366\052\351\063\253\203\251\144\301\140\307\104\154\307\211"
	"\372\256\302\064\363\055\036\244\066\373\135\342\105\247\060\244"
	"\235\132\215\321\006\021\172\153\323\333\062\030\107\371\241\102"
	"\250\144\166\233\222\225\077\310\220\234\253\326\104\333\172\342"
	"\065\007\263\074\031\056\247\355\011\331\005\121\323\247\223\173"
	"\013\012\026\235\237\125\146\060\362\021\006\066\354\200\030\042"
	"\210\314\136\241\373\006\216\005\337\223\126\263\073\352\056\106"
	"\364\105\344\224\232\112\304\215\133\312\304\107\112\335\152\322"
	"\251\310\164\245\316\002\252\256\226\001\142\321\353\220\030\337"
	"\326\374\163\160\106\070\376\241\002\302\351\115\237\123\040\111"
	"\034\224\356\353\227\231\232\055\232\374\377\206\215\027\146\143"
	"\024\331\324\132\022\322\374\024\224\346\142\063\071\202\175\126"
	"\026\153\101\255\004\334\333\237\330\333\045\145\363\213\311\007"
	"\145\337\166\372\346\333\227\110\122\007\247\337\013\353\315\103"
	"\151\075\370\076\304\031\125\371\077\110\012\004\023\366\356\104"
	"\326\144\077\275\100\327\005\223\336\254\162\351\230\077\054\002"
	"\175\045\100\102\076\226\074\175\336\107\202\361\076"
#define      lsto_z	1
#define      lsto	((&data[355]))
	"\310"
#define      text_z	3300
#define      text	((&data[737]))
	"\026\115\327\251\053\204\034\024\035\134\101\037\331\146\140\034"
	"\245\366\130\043\324\240\245\306\336\026\375\362\354\163\304\002"
	"\300\234\254\354\041\311\000\076\045\102\135\377\250\276\033\116"
	"\264\164\161\210\024\026\117\363\054\114\345\031\277\252\034\200"
	"\106\311\154\150\222\155\246\267\260\003\267\130\302\323\247\166"
	"\107\030\377\134\056\116\117\133\233\065\165\133\340\221\333\047"
	"\132\110\217\355\266\065\245\146\071\134\277\373\057\146\161\167"
	"\176\161\324\255\277\044\011\133\131\176\266\072\020\222\141\152"
	"\333\360\130\221\046\375\367\137\131\267\133\211\035\315\000\234"
	"\076\324\112\376\371\124\131\122\323\020\214\343\242\356\116\175"
	"\336\246\017\004\243\006\144\375\276\277\206\334\214\207\170\313"
	"\134\303\311\125\027\043\250\353\063\065\317\325\043\035\123\002"
	"\304\142\007\150\151\153\145\047\053\354\003\270\163\174\203\320"
	"\077\115\045\127\160\315\103\243\002\022\171\046\057\314\050\364"
	"\056\057\135\227\232\303\277\306\257\302\176\043\077\002\363\177"
	"\117\030\326\277\346\031\142\351\054\334\017\134\250\067\120\326"
	"\146\255\156\001\160\056\307\040\361\106\104\060\110\067\257\227"
	"\120\206\127\067\240\272\040\314\226\057\050\076\147\171\025\315"
	"\047\204\317\230\262\227\270\243\335\374\324\045\064\204\275\204"
	"\012\024\274\253\316\334\167\144\014\240\243\163\031\270\100\100"
	"\074\020\330\357\247\221\223\204\216\150\252\302\354\147\107\367"
	"\174\003\242\112\337\032\257\353\272\122\137\324\013\240\025\110"
	"\260\355\070\127\177\313\334\015\063\206\317\040\356\027\027\152"
	"\032\272\265\372\325\144\346\220\267\105\144\302\345\346\273\315"
	"\101\324\035\244\370\361\277\134\150\305\046\217\225\370\214\252"
	"\116\021\216\302\201\355\254\243\231\257\304\250\133\070\002\027"
	"\323\120\065\230\213\356\340\001\355\051\134\073\102\021\141\025"
	"\014\207\175\356\313\215\205\234\301\314\027\066\256\072\122\027"
	"\302\215\075\131\207\224\123\235\235\355\023\211\123\007\161\211"
	"\247\377\316\100\071\254\216\016\111\113\045\370\016\070\314\107"
	"\265\347\130\036\346\122\151\210\311\155\110\223\362\174\152\052"
	"\077\227\140\350\055\017\033\144\174\247\344\174\041\113\326\102"
	"\210\306\272\366\007\153\304\345\260\076\132\327\143\271\062\072"
	"\010\136\212\075\332\372\242\142\140\027\355\064\017\221\211\303"
	"\070\134\045\325\227\334\217\355\156\141\324\272\350\101\213\162"
	"\017\330\032\225\212\150\217\225\075\125\124\322\032\233\343\255"
	"\060\075\006\015\307\056\164\050\047\136\231\275\267\301\116\013"
	"\302\015\121\154\353\163\117\074\244\353\241\071\216\066\212\253"
	"\036\367\040\044\055\145\202\147\004\127\126\141\166\372\323\335"
	"\265\175\316\274\110\063\171\110\321\141\107\327\316\350\274\243"
	"\322\120\221\215\226\127\053\346\305\050\220\274\154\125\361\152"
	"\276\305\105\307\123\027\363\231\077\375\267\263\066\032\337\204"
	"\143\355\063\123\221\240\227\220\111\042\235\232\243\174\231\127"
	"\117\304\132\062\306\012\120\223\016\226\245\241\052\151\136\272"
	"\120\033\144\110\350\322\374\244\132\157\050\100\326\134\026\153"
	"\066\057\237\332\176\004\201\202\144\303\050\034\235\366\004\303"
	"\227\013\126\061\374\326\240\102\177\104\322\362\200\330\104\012"
	"\335\301\337\052\336\030\251\237\273\061\253\302\252\257\035\026"
	"\104\202\124\231\176\345\056\256\262\335\204\265\143\220\150\240"
	"\256\023\277\200\037\026\317\347\320\121\244\160\377\271\200\072"
	"\001\323\377\351\143\267\052\051\010\102\324\312\110\322\161\370"
	"\062\345\375\033\177\202\130\036\207\173\330\166\121\375\330\176"
	"\313\074\012\200\357\243\064\213\360\271\345\025\161\321\364\327"
	"\217\315\271\042\353\067\065\053\220\207\064\207\006\037\257\274"
	"\037\234\137\355\272\257\264\242\331\076\151\255\343\353\074\103"
	"\371\265\257\134\044\350\277\176\123\167\341\175\257\344\150\071"
	"\072\137\012\027\006\245\376\034\035\252\143\170\352\242\230\327"
	"\376\232\306\367\326\120\057\372\012\312\154\375\120\326\156\350"
	"\136\370\301\200\156\343\222\314\251\041\072\057\165\312\370\000"
	"\066\244\234\343\110\242\111\166\076\244\216\261\152\036\024\111"
	"\122\206\034\366\224\045\336\023\134\053\363\273\111\251\315\316"
	"\276\340\205\117\342\204\244\244\036\120\357\367\005\126\343\314"
	"\007\244\153\041\123\143\041\025\247\301\076\101\266\002\156\100"
	"\210\331\105\132\063\174\175\160\371\271\277\256\131\014\251\075"
	"\156\202\345\351\152\207\031\374\202\027\030\055\032\006\064\143"
	"\121\023\000\065\046\344\015\300\147\224\016\051\017\343\307\300"
	"\062\326\216\147\174\253\301\335\231\054\051\223\021\221\050\315"
	"\367\016\135\212\362\212\252\366\131\012\322\143\266\146\140\271"
	"\256\243\221\250\361\142\256\345\335\025\134\143\346\135\001\273"
	"\074\144\273\031\024\320\247\322\213\374\004\221\363\345\266\103"
	"\253\142\175\126\204\121\013\133\001\340\206\033\114\123\277\274"
	"\210\323\106\252\151\350\167\134\216\073\153\027\172\265\315\300"
	"\302\064\044\371\112\076\036\063\054\211\063\204\310\367\201\206"
	"\023\256\011\141\362\114\150\027\347\365\331\135\305\163\135\134"
	"\152\145\323\140\253\076\104\237\213\066\350\322\373\301\342\002"
	"\302\021\022\360\275\321\374\011\260\062\275\251\152\304\267\146"
	"\312\170\037\002\042\375\072\052\311\333\371\053\204\146\321\112"
	"\332\074\216\321\345\040\244\247\035\277\116\023\300\224\234\136"
	"\024\231\133\167\210\343\077\370\136\323\314\231\221\212\057\312"
	"\020\261\314\021\204\234\277\022\004\303\203\027\270\166\327\061"
	"\042\165\355\110\130\324\211\157\040\252\101\053\023\321\041\231"
	"\363\231\112\136\027\341\130\370\247\221\072\232\321\147\122\306"
	"\237\223\004\355\220\224\132\230\343\342\223\224\207\314\230\071"
	"\250\242\064\001\326\112\213\211\244\134\327\022\373\015\274\356"
	"\216\206\270\133\373\056\156\174\373\075\014\303\036\267\214\047"
	"\115\304\375\071\372\300\022\174\360\362\250\172\275\372\275\273"
	"\277\175\015\342\176\254\020\037\061\022\241\255\025\265\122\131"
	"\342\051\163\244\357\327\137\027\371\272\045\205\323\233\174\071"
	"\063\325\036\011\327\240\334\350\224\336\327\272\063\224\073\010"
	"\112\044\267\240\217\152\263\066\316\313\124\164\151\264\374\213"
	"\060\354\202\262\156\021\224\101\351\337\042\146\100\214\200\377"
	"\342\076\362\374\207\055\242\241\006\267\321\273\130\277\001\262"
	"\201\155\111\350\103\374\331\234\230\270\135\116\247\071\353\132"
	"\252\145\153\341\330\106\305\022\117\032\131\207\025\332\274\345"
	"\375\242\134\047\052\015\037\227\251\370\042\063\013\075\004\266"
	"\100\170\350\156\224\134\016\320\366\153\234\016\000\040\045\255"
	"\302\305\377\245\025\030\034\066\371\261\014\025\235\350\212\247"
	"\027\103\275\140\151\112\360\013\335\010\045\040\103\350\316\356"
	"\352\044\204\260\243\221\210\355\242\041\133\220\023\304\133\377"
	"\034\065\021\152\334\264\056\200\244\341\160\301\122\174\277\012"
	"\224\040\175\052\116\260\202\322\025\126\207\122\067\104\077\012"
	"\316\312\145\356\002\066\222\142\100\212\115\017\265\312\064\043"
	"\134\213\242\032\337\340\034\164\101\231\147\335\212\373\044\063"
	"\160\347\272\356\373\351\273\042\355\200\121\006\035\075\353\025"
	"\267\133\166\302\076\226\114\175\055\014\051\116\026\315\345\046"
	"\221\234\076\350\140\303\102\231\066\353\317\201\010\024\337\141"
	"\230\167\155\240\243\151\276\212\207\141\243\157\304\111\146\217"
	"\133\111\022\166\242\223\266\032\116\257\341\051\122\037\145\253"
	"\054\000\210\336\223\072\332\150\250\255\111\212\251\340\261\352"
	"\153\365\063\305\320\325\114\353\102\027\334\145\330\325\055\060"
	"\240\143\242\222\000\051\373\024\157\037\112\150\011\104\074\322"
	"\133\003\163\000\340\323\006\230\151\052\107\175\171\370\045\117"
	"\361\041\224\315\154\017\357\261\373\332\033\223\145\335\304\136"
	"\206\351\060\341\003\012\156\344\314\234\023\347\055\043\171\353"
	"\371\017\204\026\102\353\017\201\372\170\000\246\375\267\215\317"
	"\130\302\316\343\074\253\352\343\336\233\145\050\261\257\173\027"
	"\025\123\143\020\130\003\100\112\373\267\114\136\316\347\134\010"
	"\206\261\332\120\006\231\175\304\321\231\230\314\034\067\355\243"
	"\134\221\376\347\347\315\066\374\210\273\073\077\312\262\140\052"
	"\345\041\226\260\142\026\326\057\335\301\026\114\102\175\025\361"
	"\041\122\320\231\305\006\303\363\142\323\072\376\322\017\367\345"
	"\200\310\111\325\065\342\221\037\130\311\201\071\103\104\114\121"
	"\222\317\204\047\301\115\242\012\105\023\133\264\357\371\076\327"
	"\375\366\035\067\077\075\370\137\227\321\117\210\013\233\366\200"
	"\247\077\144\126\361\311\014\075\225\233\336\157\031\121\171\222"
	"\025\147\115\046\121\253\245\365\337\065\261\372\111\301\320\337"
	"\017\305\172\316\315\155\174\012\143\011\062\021\303\326\121\070"
	"\332\035\121\316\273\341\052\243\173\064\277\261\165\317\363\113"
	"\315\271\246\152\005\251\226\225\001\052\360\126\305\125\132\134"
	"\301\022\200\033\342\267\223\332\256\371\002\014\322\303\172\135"
	"\326\041\117\173\352\201\262\110\333\206\166\117\300\040\130\171"
	"\314\203\230\250\235\145\374\332\122\114\345\117\336\040\146\377"
	"\311\031\223\101\266\231\245\175\170\231\326\015\146\075\267\107"
	"\201\166\134\241\031\175\146\332\313\045\115\375\330\165\253\143"
	"\041\155\201\077\360\322\073\265\334\145\144\313\317\054\121\227"
	"\346\376\234\321\244\013\055\212\147\217\111\274\271\103\366\351"
	"\016\021\126\137\033\177\215\045\356\334\156\355\013\343\163\212"
	"\214\350\023\232\037\116\147\272\037\073\212\307\301\235\141\347"
	"\251\112\106\350\326\206\124\124\375\357\014\074\076\275\003\022"
	"\202\167\151\163\023\371\033\274\012\123\275\314\177\272\145\163"
	"\114\006\115\005\350\177\132\122\010\257\202\260\357\062\372\072"
	"\320\277\114\021\271\075\041\267\242\356\016\106\226\334\137\130"
	"\235\100\267\361\302\330\065\025\330\163\062\237\064\174\371\160"
	"\374\244\225\006\367\042\375\222\253\017\021\060\056\372\303\000"
	"\050\320\341\130\364\002\324\333\022\070\072\024\271\333\330\027"
	"\046\153\373\355\253\073\230\131\120\367\251\015\045\357\155\266"
	"\266\337\117\045\311\020\153\250\226\011\020\353\144\004\102\107"
	"\172\266\336\373\323\341\011\371\231\112\060\215\326\262\101\160"
	"\336\172\356\014\274\112\241\040\323\065\213\363\361\312\071\272"
	"\227\164\141\105\063\063\356\105\132\366\037\157\133\043\312\022"
	"\174\274\357\041\347\261\167\054\067\060\363\212\170\323\004\311"
	"\310\033\014\243\070\043\174\056\054\343\265\203\014\233\003\070"
	"\142\364\107\172\136\077\074\320\253\264\215\107\025\263\371\166"
	"\127\010\037\304\000\355\145\355\115\275\014\337\030\005\351\364"
	"\016\064\321\053\006\063\220\255\044\351\032\235\176\311\072\025"
	"\317\243\211\175\161\365\135\156\356\353\267\217\042\016\254\325"
	"\261\321\126\261\314\234\354\125\230\220\112\011\132\202\020\252"
	"\327\356\335\345\375\012\147\035\260\031\274\232\230\267\103\300"
	"\026\124\143\165\016\064\220\337\004\141\243\335\010\000\336\127"
	"\224\205\022\250\154\345\317\053\375\007\137\211\165\067\145\232"
	"\022\323\316\013\115\302\355\101\316\324\247\031\107\255\307\104"
	"\340\014\262\273\307\362\035\254\135\200\340\371\045\253\167\133"
	"\263\307\155\225\237\012\250\077\063\127\177\244\367\237\013\356"
	"\055\270\233\053\025\347\127\154\220\054\337\123\276\262\204\363"
	"\154\120\325\026\046\110\177\347\074\162\252\302\342\337\313\275"
	"\315\242\211\022\241\075\217\065\041\240\223\134\370\275\124\053"
	"\227\357\355\360\374\345\316\352\366\174\026\073\166\101\105\365"
	"\277\153\113\100\013\163\107\057\321\273\136\147\167\346\175\226"
	"\210\344\273\040\121\363\132\302\236\050\207\213\027\200\235\323"
	"\313\011\151\113\242\123\265\174\215\033\124\206\347\121\314\356"
	"\102\352\147\366\201\104\214\335\124\072\024\241\341\356\330\223"
	"\374\140\334\147\077\276\243\213\047\322\224\210\217\126\207\346"
	"\370\141\205\177\320\261\167\126\155\176\060\334\166\055\224\152"
	"\027\365\125\033\331\221\262\237\320\076\246\114\206\177\302\204"
	"\330\071\155\147\001\376\213\357\142\065\060\004\247\175\074\055"
	"\204\305\312\103\032\200\014\350\311\024\144\254\070\347\337\337"
	"\175\270\342\120\025\341\233\120\353\364\005\064\135\241\174\165"
	"\300\321\236\244\344\266\220\124\335\115\350\365\307\355\161\347"
	"\067\024\061\125\240\277\340\135\277\344\000\057\341\315\173\305"
	"\043\006\207\074\074\027\074\047\110\330\335\177\251\042\042\347"
	"\303\216\373\222\322\106\175\027\043\340\020\311\103\370\326\301"
	"\300\266\147\062\333\277\361\372\161\122\031\226\300\176\021\121"
	"\007\250\035\356\232\211\111\143\322\306\014\003\177\260\204\052"
	"\210\327\263\350\123\212\241\137\041\254\063\312\073\205\243\202"
	"\033\064\355\006\072\256\324\075\040\240\273\213\360\067\343\210"
	"\353\035\145\165\257\307\157\213\234\031\322\303\050\062\064\125"
	"\170\233\137\235\264\065\170\357\052\235\040\312\225\017\074\243"
	"\115\161\173\132\334\034\070\214\071\026\265\217\177\147\001\012"
	"\041\271\333\225\352\362\347\360\344\352\134\217\176\047\151\155"
	"\200\017\076\113\347\040\231\015\157\316\357\363\255\363\115\271"
	"\120\217\103\071\171\030\014\275\375\234\133\010\203\203\334\053"
	"\365\033\370\364\241\070\313\172\107\104\361\033\120\274\167\222"
	"\214\003\005\325\063\101\075\144\164\062\122\371\135\157\323\367"
	"\132\056\244\120\270\263\061\020\355\355\315\335\000\130\225\224"
	"\165\233\317\012\176\123\066\236\232\122\364\355\306\366\126\032"
	"\357\014\244\276\004\302\142\307\176\276\154\244\376\164\127\265"
	"\236\007\307\214\020\257\240\135\367\241\123\253\077\110\220\356"
	"\340\305\167\351\073\046\141\315\355\047\040\007\134\064\112\123"
	"\036\356\343\141\166\274\173\335\034\104\145\310\150\151\350\326"
	"\122\376\362\173\370\000\115\365\267\334\032\261\131\074\340\002"
	"\272\007\261\213\351\125\346\037\115\162\164\252\237\250\163\115"
	"\103\113\013\227\010\105\260\103\173\124\104\344\212\352\053\350"
	"\363\355\033\346\300\232\350\224\370\201\220\003\236\034\347\053"
	"\350\251\371\021\152\300\034\130\272\351\337\256\050\037\027\210"
	"\265\115\254\131\333\207\045\067\073\034\012\012\100\262\331\332"
	"\160\073\153\353\306\021\360\302\376\265\055\033\341\016\323\211"
	"\141\214\023\251\341\076\143\356\333\232\154\172\171\037\230\247"
	"\364\044\351\331\120\230\020\175\256\223\172\363\214\030\112\044"
	"\356\106\242\146\131\160\035\122\251\175\274\237\070\342\011\373"
	"\344\232\232\174\034\347\054\263\146\100\354\301\166\113\020\222"
	"\073\364\314\367\233\030\144\120\122\376\120\250\073\247\232\171"
	"\003\010\074\375\342\037\344\163\042\257\150\045\316\046\317\345"
	"\277\011\230\356\314\115\132\105\037\336\377\052\103\165\047\376"
	"\142\241\316\041\126\347\340\301\351\221\364\203\113\371\056\155"
	"\021\360\343\234\321\277\253\171\042\253\173\147\142\341\002\265"
	"\320\154\043\372\134\002\103\013\033\312\050\365\025\217\057\164"
	"\375\106\121\253\117\105\300\257\125\272\062\002\054\156\024\212"
	"\273\041\272\043\147\314\051\337\317\231\124\236\003\033\122\104"
	"\133\155\152\001\332\051\310\100\012\022\370\073\324\323\157\252"
	"\026\303\264\133\276\246\353\332\074\076\362\172\160\216\117\330"
	"\215\147\267\073\334\205\162\314\133\032\031\104\335\040\313\076"
	"\161\157\373\017\234\013\012\340\106\162\023\132\307\315\333\073"
	"\264\133\121\275\270\313\360\116\250\033\245\347\006\136\244\017"
	"\072\065\267\217\021\267\253\076\025\172\371\031\162\115\052\306"
	"\123\240\110\151\126\275\362\345\274\177\242\365\116\353\012\324"
	"\230\304\240\111\263\277\020\111\267\066\154\274\066\044\343\265"
	"\024\352\130\206\363\237\330\027\274\242\351\124\312\205\121\360"
	"\361\176\220\336\371\352\036\315\036\054\046\142\013\250\253\231"
	"\320\024\325\115\306\354\330\153\111\360\110\135\142\004\304\344"
	"\045\366\127\210\376\247\355\317\224\325\341\035\013\357\053\172"
	"\032\171\013\225\147\103\355\347\017\311\364\103\120\304\143\076"
	"\333\173\250\366\066\135\361\013\302\327\233\171\035\000\074\002"
	"\171\110\230\341\213\206\310\233\120\275\336\240\201\101\336\135"
	"\275\206\124\363\344\105\376\247\035\232\040\072\232\135\075\024"
	"\246\326\365\061\134\276\314\254\173\253\114\374\354\052\132\252"
	"\261\256\235\226\364\234\075\021\066\136\113\321\274\210\345\142"
	"\136\332\224\273\231\141\147\024\014\264\021\371\337\153\243\221"
	"\032\101\047\016\335\145\037\024\304\153\345\200\364\313\343\122"
	"\246\167\016\077\330\166\123\345\052\144\336\011\320\202\233\352"
	"\303\303\371\241\050\030\265\354\203\233\155\167\146\120\312\015"
	"\310\331\114\241\117\237\206\171\004\145\203\324\347\036\277\252"
	"\341\270\113\012\321\001\367\124\235\144\314\004\265\227\021\175"
	"\160\135\036\277\375\244\071\001\012\274\326\361\333\225\233\275"
	"\116\347\307\037\351\276\164\206\042\101\212\330\330\234\125\111"
	"\371\163\011\366\030\102\370\042\377\316\023\332\144\257\227\262"
	"\227\137\322\200\035\106\007\100\207\222\030\140\056\156\251\047"
	"\341\262\036\372\365\027\035\365\346\061\317\112\341\147\375\170"
	"\307\317\371\344\025\000\045\235\222\076\375\300\254\246\350\216"
	"\131\007\211\117\036\246\104\004\330\024\117\271\173\114\061\103"
	"\033\053\050\061\053\115\316\276\213\313\177\070\162\147\307\314"
	"\156\120\033\215\367\137\221\317\163\340\210\357\055\272\062\111"
	"\345\132\172\020\250\111\317\064\025\116\154\207\265\064\124\044"
	"\204\157\261\173\317\103\112\103\044\322\062\121\215\145\232\162"
	"\300\025\203\150\136\122\235\163\240\012\373\125\076\117\172\303"
	"\277\054\076\216\157\211\322\224\134\004\345\351\152\200\133\053"
	"\225\336\224\363\060\061\147\320\073\142\046\172\262\241\075\161"
	"\315\174\000\074\005\322\320\141\327\266\113\101\066\247\155\314"
	"\205\001\300\266\062\047\207\156\212\256\350\074\117\045\256\034"
	"\241\256\131\247\201\052\011\130\340\124\232\027\373\007\344\201"
	"\010\244\070\073\313\277\251\126\156\221\222\275\267\100\332\131"
	"\357\063\000\161\136\011\311\077\136\144\126\132\154\072\333\165"
	"\337\024\260\253\324\132\001\102\353\223\000\243\324\332\375\304"
	"\016\375\065\154\007\377\253\146\143\002\300\320\075\234\105\034"
	"\260\365\307\204\117\310\306\073\134\307\337\061\241\334\366\257"
	"\332\053\034\342\053\307\110\216\311\011\137\006\246\244\043\126"
	"\232\352\333\352\263\242\046\020\151\005\101\012\342\067\272\275"
	"\143\326\237\216\236\350\035\150\362\174\156\230\041\222\356\273"
	"\175\311\246\060\154\314\100\325\322\202\340\264\272\232\161\035"
	"\161\021\253\017\371\310\167\353\105\346\203\146\171\162\042\366"
	"\074\310\046\250\224\147\175\146\351\135\033\243\370\214\301\152"
	"\235\154\172\227\065\362\203\173\331\006\341\122\171\003\110\265"
	"\314\157\136\140\326\333\307\300\071\342\144\062\157\045\234\015"
	"\222\026\244\307\010"
#define      date_z	11
#define      date	((&data[4713]))
	"\017\046\104\021\314\070\223\205\041\230\010\056\044"
#define      shll_z	10
#define      shll	((&data[4727]))
	"\174\031\254\036\126\343\030\042\221\245\167"
#define      xecc_z	15
#define      xecc	((&data[4740]))
	"\272\125\302\061\305\376\351\106\174\026\222\267\015\016\346\216"
	"\161\307\226\035\202"
#define      tst2_z	19
#define      tst2	((&data[4762]))
	"\003\156\014\237\063\341\166\064\156\155\177\220\351\034\141\152"
	"\227\367\004\020\061\320\213\173\236\266\040"
#define      tst1_z	22
#define      tst1	((&data[4789]))
	"\251\241\165\316\376\147\350\354\176\222\126\242\345\264\013\204"
	"\233\312\232\366\370\157\010\201\147\234\325"
#define      msg1_z	83
#define      msg1	((&data[4832]))
	"\172\354\075\065\101\377\313\136\202\234\136\151\237\315\166\077"
	"\111\025\365\151\302\373\255\336\060\172\014\251\157\077\327\071"
	"\020\222\330\005\366\241\117\060\233\125\253\026\273\203\264\263"
	"\166\162\120\263\225\200\366\016\254\325\267\020\213\273\056\023"
	"\057\106\056\007\132\266\371\073\373\374\055\361\050\131\017\174"
	"\113\236\246\205\073\040\310\256\053\371\332\144\257\256\367\027"
	"\075\005\240\106\143\237\175\173\264\261\045\126\047"
#define      chk2_z	19
#define      chk2	((&data[4921]))
	"\366\330\262\072\306\260\354\243\135\065\204\343\145\156\104\105"
	"\133\030\303\352"
#define      chk1_z	22
#define      chk1	((&data[4945]))
	"\273\364\030\273\150\020\326\347\263\014\332\303\353\077\052\001"
	"\330\126\100\310\306\161\311\000\271\014\277\167\075\134\326"
#define      rlax_z	1
#define      rlax	((&data[4972]))
	"\243"
#define      inlo_z	3
#define      inlo	((&data[4973]))
	"\060\213\371"
#define      opts_z	1
#define      opts	((&data[4976]))
	"\140"/* End of data[] */;
#define      hide_z	4096
#define SETUID 1	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	1	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
